{"version":3,"sources":["loaders.js","scene.js","gui.js","FBOCompositor.js","hud.js","particle.js","main.js","run.js","events.js","util.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;AACb,IAAI,cAAc,GAAG,IAAI,KAAK,CAAC,cAAc,EAAE,CAAC;AAChD,cAAc,CAAC,MAAM,GAAG,YAAM;;AAE7B,KAAI,EAAE,CAAC;AACP,IAAG,EAAE,CAAC;CAEN,CAAC;;AAEF,cAAc,CAAC,UAAU,GAAG,UAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAM;;AAEtD,QAAO,CAAC,GAAG,CAAE,MAAM,GAAG,GAAG,GAAG,KAAK,EAAE,IAAI,CAAE,CAAC;CAE1C,CAAC;;AAEF,IAAI,OAAO,GAAG,EAAE,CAAC;AACjB,IAAI,YAAY,GAAG,IAAI,KAAK,CAAC,SAAS,CAAE,cAAc,CAAE,CAAC;AACzD,YAAY,CAAC,eAAe,CAAE,MAAM,CAAE,CAAC;AACvC,YAAY,CAAC,UAAU,GAAG,IAAI,CAAC;;AAE/B,YAAY,CAAC,WAAW,GAAG,UAAE,OAAO,EAAE,MAAM,EAAM;;AAEjD,OAAM,CAAC,IAAI,CAAE,MAAM,CAAE,CAAC,OAAO,CAAE,UAAE,GAAG,EAAM;;AAEzC,cAAY,CAAC,IAAI,CAAE,MAAM,CAAE,GAAG,CAAE,EAAE,UAAE,MAAM,EAAM;;AAE/C,UAAO,CAAE,GAAG,CAAE,GAAG,MAAM,CAAC;GAExB,CAAE,CAAC;EAEJ,CAAE,CAAC;CAEJ,CAAC;;AAEF,YAAY,CAAC,WAAW,CAAE,OAAO,EAAE;;AAElC,SAAQ,EAAE,mBAAmB;AAC7B,SAAQ,EAAE,mBAAmB;;AAE7B,QAAO,EAAE,kBAAkB;AAC3B,QAAO,EAAE,kBAAkB;;AAE3B,aAAY,EAAE,uBAAuB;AACrC,aAAY,EAAE,uBAAuB;;AAErC,SAAQ,EAAE,uBAAuB;AACjC,SAAQ,EAAE,uBAAuB;;AAEjC,KAAI,EAAE,wBAAwB;;AAE9B,eAAc,EAAE,yBAAyB;AACzC,eAAc,EAAE,yBAAyB;;CAGzC,CAAE,CAAC;;AAEJ,IAAI,QAAQ,GAAG,EAAE,CAAC;AAClB,IAAI,aAAa,GAAG,IAAI,KAAK,CAAC,aAAa,CAAE,cAAc,CAAE,CAAC;AAC9D,aAAa,CAAC,IAAI,CAAE,4BAA4B,EAAE,UAAE,GAAG,EAAM;AAC5D,SAAQ,CAAC,QAAQ,GAAG,GAAG,CAAC;CACxB,CAAE,CAAC;;AC5DJ,YAAY,CAAC;;AAEb,IAAK,CAAC,QAAQ,CAAC,KAAK,EAAE;AACrB,SAAQ,CAAC,kBAAkB,EAAE,CAAC;CAC9B;;AAED,IAAI,EAAE,GAAG,EAAE,CAAC;AACZ,IAAI,MAAM,EAAE,KAAK,CAAC;AAClB,IAAI,KAAK,EAAE,MAAM,EAAE,WAAW,EAAE,QAAQ,CAAC;AACzC,IAAI,KAAK,GAAG,MAAM,CAAC,UAAU,CAAC;AAC9B,IAAI,MAAM,GAAG,MAAM,CAAC,WAAW,CAAC;AAChC,IAAI,WAAW,GAAG,MAAM,CAAC,iBAAiB,IAAI,CAAC,CAAC;AAChD,IAAI,YAAY,GAAG,KAAK,GAAG,MAAM,CAAC;AAClC,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;;;AAG9B,IAAI,cAAc,GAAG;;AAEpB,QAAO,EAAE,OAAQ;AACjB,MAAK,EAAE,KAAK;AACZ,iBAAgB,EAAE,KAAK;AACvB,iBAAgB,EAAE,KAAK;AACvB,gBAAe,EAAE,IAAI;;CAErB,CAAC;;;AAGD,MAAM,GAAG,QAAQ,CAAC,cAAc,CAAE,QAAQ,CAAE,CAAC;AAC7C,KAAK,GAAG,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;;;AAG1B,MAAM,GAAG,IAAI,KAAK,CAAC,iBAAiB,CAAE,EAAE,EAAE,YAAY,EAAE,EAAE,EAAE,MAAM,CAAE,CAAC;AACrE,WAAW,GAAG,IAAI,KAAK,CAAC,aAAa,CAAE,MAAM,EAAE,MAAM,CAAE,CAAC;AACxD,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAE,CAAC,iBAAiB,EAAE,kBAAkB,EAAE,iBAAiB,CAAE,CAAC;AACjF,MAAM,CAAC,UAAU,CAAC,GAAG,CAAE,CAAC,mBAAmB,EAAE,CAAC,iBAAiB,EAAE,mBAAmB,EAAE,kBAAkB,CAAE,CAAC;AAC3G,WAAW,CAAC,MAAM,CAAC,GAAG,CAAE,kBAAkB,EAAE,CAAC,kBAAkB,EAAE,kBAAkB,CAAE,CAAC;AACtF,WAAW,CAAC,MAAM,EAAE,CAAC;;;AAGrB,QAAQ,GAAG,IAAI,KAAK,CAAC,aAAa,CAAE,EAAE,SAAS,EAAE,KAAK,EAAG,KAAK,EAAE,IAAI,EAAE,CAAE,CAAC;AACzE,QAAQ,CAAC,OAAO,CAAE,KAAK,EAAE,MAAM,CAAE,CAAC;AAClC,QAAQ,CAAC,aAAa,CAAE,WAAW,CAAE,CAAC;AACtC,QAAQ,CAAC,aAAa,CAAE,cAAc,CAAC,OAAO,EAAE,CAAG,CAAE,CAAC;AACtD,QAAQ,CAAC,SAAS,GAAG,KAAK,CAAC;;AAE3B,MAAM,CAAC,WAAW,CAAE,QAAQ,CAAC,UAAU,CAAE,CAAC;;;AAG1C,KAAK,GAAG,IAAI,KAAK,EAAE,CAAC;AACpB,MAAM,CAAC,WAAW,CAAE,KAAK,CAAC,UAAU,CAAE,CAAC;;;AAGvC,IAAI,UAAU,GAAG,IAAI,KAAK,CAAC,UAAU,CAAE,GAAG,EAAE,EAAE,CAAE,CAAC;AACjD,UAAU,CAAC,SAAS,CAAE,CAAC,CAAE,CAAC;AAC1B,UAAU,CAAC,QAAQ,CAAC,OAAO,GAAG,GAAG,CAAC;AAClC,UAAU,CAAC,QAAQ,CAAC,WAAW,GAAG,IAAI,CAAC;AACvC,UAAU,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC;AAC7B,KAAK,CAAC,GAAG,CAAE,UAAU,CAAE,CAAC;;AAExB,IAAI,UAAU,GAAG,IAAI,KAAK,CAAC,UAAU,CAAE,IAAI,CAAE,CAAC;AAC9C,KAAK,CAAC,GAAG,CAAE,UAAU,CAAE,CAAC;;AAExB,SAAS,aAAa,GAAG;AACxB,WAAU,CAAC,OAAO,GAAG,cAAc,CAAC,gBAAgB,CAAC;AACrD,WAAU,CAAC,OAAO,GAAG,cAAc,CAAC,gBAAgB,CAAC;CACrD;AACD,aAAa,EAAE,CAAC;AClEjB,YAAY,CAAC;;AAEb,IAAI,GAAG,EAAE,WAAW,EAAE,YAAY,CAAC;;AAEnC,SAAS,OAAO,GAAG;;;;AAIlB,IAAG,GAAG,IAAI,GAAG,CAAC,GAAG,EAAE,CAAC;AACpB,IAAG,CAAC,KAAK,GAAG,GAAG,CAAC;;AAEhB,YAAW,GAAG,GAAG,CAAC,SAAS,CAAE,SAAS,CAAE,CAAC;AACxC,YAAW,CAAC,UAAU,GAAG,KAAK,CAAC;;AAEhC,aAAY,GAAG,GAAG,CAAC,SAAS,CAAE,UAAU,CAAE,CAAC;;AAE1C,aAAY,CAAC,QAAQ,CAAE,cAAc,EAAE,SAAS,CAAE,CAAC,IAAI,CAAE,YAAY,CAAE,CAAC;AACxE,aAAY,CAAC,GAAG,CAAE,MAAM,EAAE,KAAK,EAAE,EAAE,EAAE,GAAG,EAAE,CAAC,CAAE,CAAC,IAAI,CAAE,KAAK,CAAE,CAAC;;AAE5D,aAAY,CAAC,GAAG,CAAE,EAAE,CAAC,aAAa,CAAC,QAAQ,EAAE,OAAO,EAAE,CAAG,EAAE,GAAG,EAAI,IAAI,CAAE,CAAC,IAAI,CAAE,iBAAiB,CAAE,CAAC;AACnG,aAAY,CAAC,GAAG,CAAE,EAAE,CAAC,aAAa,CAAC,SAAS,EAAE,OAAO,EAAE,CAAG,EAAE,CAAG,EAAI,IAAI,CAAE,CAAC,IAAI,CAAE,WAAW,CAAE,CAAC;AAC9F,aAAY,CAAC,GAAG,CAAE,EAAE,CAAC,aAAa,CAAC,KAAK,EAAE,OAAO,EAAE,CAAG,EAAE,GAAK,EAAE,IAAI,CAAE,CAAC,IAAI,CAAE,OAAO,CAAE,CAAC;AACtF,aAAY,CAAC,GAAG,CAAE,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,OAAO,EAAE,CAAG,EAAE,EAAI,EAAG,IAAI,CAAE,CAAC,IAAI,CAAE,MAAM,CAAE,CAAC;AAC7F,aAAY,CAAC,GAAG,CAAE,cAAc,EAAE,iBAAiB,CAAE,CAAC,IAAI,CAAE,mBAAmB,CAAE,CAAC;;AAGnF,YAAW,CAAC,IAAI,EAAE,CAAC;AACnB,aAAY,CAAC,IAAI,EAAE,CAAC;;AAEpB,aAAY,CAAC,aAAa,CAAC,OAAO,CAAE,UAAE,UAAU,EAAM;AACrD,YAAU,CAAC,QAAQ,CAAE,cAAc,CAAE,CAAC;EACtC,CAAE,CAAC;CAEJ;;AAED,SAAS,cAAc,GAAG;;AAEzB,OAAM,CAAC,sBAAsB,EAAE,CAAC;AAChC,GAAE,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,CAAE,cAAc,CAAC,OAAO,CAAE,CAAC;;CAGhD;;AAED,SAAS,gBAAgB,GAAG;;AAE3B,YAAW,CAAC,aAAa,CAAC,OAAO,CAAE,UAAE,UAAU,EAAM;AACpD,YAAU,CAAC,aAAa,EAAE,CAAC;EAC3B,CAAE,CAAC;CAEJ;ACjDD,YAAY,CAAC;;AAEb,SAAS,aAAa,CAAE,QAAQ,EAAE,UAAU,EAAE,oBAAoB,EAAG;;AAEpE,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;;AAEzB,KAAI,CAAC,mBAAmB,EAAE,CAAC;AAC3B,KAAI,CAAC,UAAU,GAAG,UAAU,CAAC;AAC7B,KAAI,CAAC,oBAAoB,GAAG,oBAAoB,CAAC;AACjD,KAAI,cAAc,GAAG,UAAU,GAAG,GAAG,CAAC;AACtC,KAAI,CAAC,MAAM,GAAG,IAAI,KAAK,CAAC,kBAAkB,CAAE,CAAC,cAAc,EAAE,cAAc,EAAE,cAAc,EAAE,CAAC,cAAc,EAAE,CAAC,EAAE,EAAE,CAAE,CAAC;AACtH,KAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;AAC3B,KAAI,CAAC,IAAI,GAAG,IAAI,KAAK,CAAC,IAAI,CAAE,IAAI,KAAK,CAAC,mBAAmB,CAAE,CAAC,EAAE,CAAC,CAAE,EAAE,IAAI,CAAE,CAAC;AAC1E,KAAI,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;AAC/B,KAAI,CAAC,KAAK,CAAC,GAAG,CAAE,IAAI,CAAC,IAAI,CAAE,CAAC;AAC5B,KAAI,CAAC,iBAAiB,GAAG,IAAI,KAAK,CAAC,iBAAiB,CAAE,CAAC,EAAE,CAAC,CAAE,CAAC;;AAE7D,KAAI,CAAC,cAAc,GAAG,IAAI,KAAK,CAAC,cAAc,CAAE;;AAE/C,UAAQ,EAAE;AACT,aAAU,EAAE;AACX,QAAI,EAAE,IAAI;AACV,SAAK,EAAE,IAAI,KAAK,CAAC,OAAO,CAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,CAAE;IAC5D;AACD,cAAW,EAAE;AACZ,QAAI,EAAE,GAAG;AACT,SAAK,EAAE,IAAI;IACX;GACD;AACD,cAAY,EAAE,OAAO,CAAC,QAAQ;AAC9B,gBAAc,EAAE,OAAO,CAAC,QAAQ;AAChC,UAAQ,EAAE,KAAK,CAAC,UAAU;;EAE1B,CAAE,CAAC;;AAEJ,KAAI,CAAC,MAAM,GAAG,EAAE,CAAC;;;AAGjB,KAAI,CAAC,aAAa,GAAG,AAAE,IAAI,CAAC,IAAI,CAAE,IAAI,CAAC,UAAU,GAAC,IAAI,CAAC,UAAU,CAAE,IAAK,IAAI,CAAC,IAAI,CAAE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAE,GAAG,CAAC,CAAA,AAAE,GAAK,CAAC,CAAC;AACnI,QAAO,CAAC,GAAG,CAAE,IAAI,CAAC,aAAa,CAAE,CAAC;AAClC,KAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;AACnB,KAAI,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;CAEpB;;AAED,aAAa,CAAC,SAAS,GAAG;;AAEzB,oBAAmB,EAAE,+BAAY;;AAEhC,MAAI,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;AACpC,MAAK,CAAC,EAAE,CAAC,YAAY,CAAE,mBAAmB,CAAE,EAAG;AAC9C,UAAO,CAAC,KAAK,CAAE,gCAAgC,CAAE,CAAC;GAClD;;AAED,MAAK,EAAE,CAAC,YAAY,CAAE,EAAE,CAAC,8BAA8B,CAAE,KAAK,CAAC,EAAG;AACjE,UAAO,CAAC,KAAK,CAAE,wCAAwC,CAAE,CAAC;GAC1D;EAED;;AAED,QAAO,EAAE,iBAAW,IAAI,EAAG;;AAE1B,MAAI,IAAI,GAAG,IAAI,CAAC;AAChB,MAAI,CAAC,MAAM,CAAC,IAAI,CAAE,UAAW,QAAQ,EAAG;;AAEvC,OAAI,IAAI,GAAG,QAAQ,CAAC,IAAI,KAAK,IAAI,CAAC;AAClC,OAAK,IAAI,EAAG,IAAI,GAAG,QAAQ,CAAC;AAC5B,UAAO,IAAI,CAAC;GAEZ,CAAE,CAAC;;AAEJ,SAAO,IAAI,CAAC;EAEZ;;AAED,QAAO,EAAE,iBAAW,IAAI,EAAE,cAAc,EAAE,YAAY,EAAE,QAAQ,EAAG;;AAElE,MAAI,IAAI,GAAG,IAAI,OAAO,CAAE,IAAI,EAAE,IAAI,CAAC,oBAAoB,EAAE,cAAc,EAAE,IAAI,CAAC,UAAU,CAAE,CAAC;AAC3F,MAAI,CAAC,eAAe,GAAG,YAAY,IAAK,EAAE,CAAC;AAC3C,MAAI,CAAC,aAAa,CAAE,QAAQ,IAAI,EAAE,CAAE,CAAC;AACrC,MAAI,CAAC,MAAM,CAAC,IAAI,CAAE,IAAI,CAAE,CAAC;AACzB,SAAO,IAAI,CAAC;EAEZ;;AAED,uBAAsB,EAAE,kCAAY;;AAEnC,MAAI,IAAI,GAAG,IAAI,CAAC;AAChB,MAAI,CAAC,MAAM,CAAC,OAAO,CAAE,UAAW,QAAQ,EAAG;;AAE1C,SAAM,CAAC,IAAI,CAAE,QAAQ,CAAC,eAAe,CAAE,CAAC,OAAO,CAAE,UAAW,eAAe,EAAG;;AAE7E,QAAI,UAAU,GAAG,QAAQ,CAAC,eAAe,CAAE,eAAe,CAAE,CAAC;AAC7D,YAAQ,CAAC,cAAc,CAAE,eAAe,EAAE,IAAI,CAAC,OAAO,CAAE,UAAU,CAAE,CAAC,eAAe,EAAE,CAAE,CAAC;IAEzF,CAAE,CAAC;GAEJ,CAAE,CAAC;EAEJ;;AAED,YAAW,EAAE,qBAAW,MAAM,EAAE,UAAU,EAAG;;AAE5C,MAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC;AAC5B,MAAI,CAAC,QAAQ,CAAC,MAAM,CAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,EAAE,UAAU,EAAE,IAAI,CAAE,CAAC;EAElE;;AAED,oBAAmB,EAAE,6BAAW,WAAW,EAAE,MAAM,EAAG;;AAErD,MAAI,IAAI,GAAG,IAAI,CAAC,OAAO,CAAE,MAAM,CAAE,CAAC;AAClC,MAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,WAAW,CAAC,KAAK,GAAG,WAAW,CAAC;AAC7D,MAAI,CAAC,WAAW,CAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,YAAY,CAAE,CAAC,CAAE,CAAE,CAAC;AAChE,MAAI,CAAC,WAAW,CAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,YAAY,CAAE,CAAC,CAAE,CAAE,CAAC;;;;;AAKhE,MAAI,CAAC,QAAQ,CAAC,eAAe,CAAE,IAAI,CAAC,iBAAiB,CAAE,CAAC;EAExD;;AAED,KAAI,EAAE,gBAAY;;AAEjB,OAAM,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAG;;AAE9C,OAAI,CAAC,sBAAsB,EAAE,CAAC;AAC9B,OAAI,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAE,CAAC,CAAE,CAAC;;AAEhC,OAAK,QAAQ,CAAC,IAAI,KAAK,UAAU,EAAG;;;AAGnC,QAAI,CAAC,mBAAmB,CAAE,IAAI,CAAC,OAAO,CAAE,cAAc,CAAE,CAAC,eAAe,EAAE,EAAE,QAAQ,CAAC,IAAI,CAAE,CAAC;;AAE5F,SAAM,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC,EAAG,EAAG;;AAEhD,SAAI,CAAC,QAAQ,EAAG,CAAC;AACb,SAAK,IAAI,CAAC,QAAQ,GAAI,CAAC,EAAG;AAC7B,UAAI,CAAC,SAAS,EAAG,CAAC;AAClB,UAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC;MAC3B;;AAEL,aAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,GAAI,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC;AACnD,aAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC;;;;;;AAMpD,SAAI,CAAC,WAAW,CAAE,QAAQ,CAAC,SAAS,EAAE,EAAE,QAAQ,CAAC,eAAe,EAAE,CAAE,CAAC;AACrE,aAAQ,CAAC,UAAU,EAAE,CAAC;KAEtB;;;AAGD,QAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;AACnB,QAAI,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;IAEpB,MAAM;;;AAGN,QAAI,CAAC,WAAW,CAAE,QAAQ,CAAC,SAAS,EAAE,EAAE,QAAQ,CAAC,eAAe,EAAE,CAAE,CAAC;AACrE,YAAQ,CAAC,UAAU,EAAE,CAAC;IAEtB;GAED;EAED;AAFC;CAIF,CAAC;;AAGF,SAAS,OAAO,CAAE,IAAI,EAAE,YAAY,EAAE,cAAc,EAAE,UAAU,EAAG;;AAElE,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;AACjB,KAAI,CAAC,YAAY,GAAG,YAAY,CAAC;AACjC,KAAI,CAAC,cAAc,GAAG,cAAc,CAAC;AACrC,KAAI,CAAC,UAAU,GAAG,UAAU,CAAC;;AAE7B,KAAI,CAAC,aAAa,GAAG,CAAC,CAAC;AACvB,KAAI,CAAC,YAAY,GAAG,EAAE,CAAC;AACvB,KAAI,CAAC,YAAY,CAAE,CAAC,CAAE,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;AACrD,KAAI,CAAC,YAAY,CAAE,CAAC,CAAE,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;;AAErD,KAAI,CAAC,eAAe,GAAG,EAAE,CAAC;;AAE1B,KAAI,CAAC,QAAQ,GAAG;AACf,YAAU,EAAE;AACX,OAAI,EAAE,IAAI;AACV,QAAK,EAAE,IAAI,KAAK,CAAC,OAAO,CAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,CAAE;GAC5D;AACD,cAAY,EAAE;AACb,OAAI,EAAE,GAAG;AACT,QAAK,EAAE,IAAI,CAAC,YAAY,CAAE,CAAC,CAAE;GAC7B;EACD,CAAC;;AAEF,KAAI,CAAC,MAAM,GAAG,IAAI,KAAK,CAAC,cAAc,CAAE;;AAEvC,UAAQ,EAAE,IAAI,CAAC,QAAQ;AACvB,cAAY,EAAE,IAAI,CAAC,YAAY;AAC/B,gBAAc,EAAE,IAAI,CAAC,cAAc;AACnC,UAAQ,EAAE,KAAK,CAAC,UAAU;;EAE1B,CAAE,CAAC;CAEJ;;AAED,OAAO,CAAC,SAAS,GAAG;;AAEnB,UAAS,EAAE,qBAAY;AACtB,SAAO,IAAI,CAAC,MAAM,CAAC;EACnB;AACD,gBAAe,EAAE,2BAAY;AAC5B,SAAO,IAAI,CAAC,YAAY,CAAE,IAAI,CAAC,aAAa,CAAE,CAAC;EAC/C;AACD,eAAc,EAAE,wBAAW,eAAe,EAAE,WAAW,EAAG;AACzD,MAAI,CAAC,QAAQ,CAAE,eAAe,CAAE,GAAG;AAClC,OAAI,EAAE,GAAG;AACT,QAAK,EAAE,WAAW;GAClB,CAAC;EACF;AACD,WAAU,EAAE,sBAAY;;AAEvB,MAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAE,IAAI,CAAC,aAAa,CAAE,CAAC;AAC3E,MAAI,CAAC,aAAa,IAAI,CAAC,CAAC;EAExB;AACD,qBAAoB,EAAE,gCAAY;;AAEjC,MAAI,MAAM,GAAG,IAAI,KAAK,CAAC,iBAAiB,CAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,EAAE;;AAE3E,QAAK,EAAE,KAAK,CAAC,mBAAmB;AAChC,QAAK,EAAE,KAAK,CAAC,mBAAmB;AAChC,YAAS,EAAE,KAAK,CAAC,aAAa;AAC9B,YAAS,EAAE,KAAK,CAAC,aAAa;AAC9B,SAAM,EAAE,KAAK,CAAC,UAAU;AACxB,OAAI,EAAE,KAAK,CAAC,SAAS;AACrB,gBAAa,EAAE,KAAK;AACpB,cAAW,EAAE,KAAK;;GAElB,CAAE,CAAC;;AAEJ,SAAO,MAAM,CAAC;EAEd;AACD,cAAa,EAAE,uBAAW,aAAa,EAAG;;AAEzC,MAAI,IAAI,GAAG,IAAI,CAAC;AAChB,QAAM,CAAC,IAAI,CAAE,aAAa,CAAE,CAAC,OAAO,CAAE,UAAW,GAAG,EAAG;;AAEtD,OAAI,CAAC,QAAQ,CAAE,GAAG,CAAE,GAAG,aAAa,CAAE,GAAG,CAAE,CAAC;GAE5C,CAAE,CAAC;EAEJ;;CAED,CAAC;AClQF,YAAY,CAAC;;AAEb,SAAS,GAAG,CAAE,QAAQ,EAAG;;AAExB,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;AACzB,KAAI,CAAC,SAAS,GAAG,IAAI,CAAC;AACtB,KAAI,SAAS,GAAG,CAAG,GAAG,CAAG,CAAC;AAC1B,KAAI,QAAQ,GAAG,SAAS,CAAC;;AAEzB,KAAI,CAAC,MAAM,GAAG,IAAI,KAAK,CAAC,kBAAkB,CAAE,CAAC,YAAY,EAAE,YAAY,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAE,CAAC;AACxF,KAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;;AAE3B,KAAI,CAAC,WAAW,GAAG,IAAI,KAAK,CAAC,cAAc,CAAE;;AAE5C,UAAQ,EAAE;AACT,WAAQ,EAAE;AACT,QAAI,EAAE,GAAG;AACT,SAAK,EAAE,IAAI,CAAC,OAAO;IACnB;GACD;AACD,cAAY,EAAE,OAAO,CAAC,OAAO;AAC7B,gBAAc,EAAE,OAAO,CAAC,OAAO;;EAE/B,CAAE,CAAC;;AAGJ,KAAI,CAAC,MAAM,GAAG,IAAI,KAAK,CAAC,mBAAmB,CAAE,QAAQ,EAAE,SAAS,CAAE,CAAC;AACnE,KAAI,CAAC,MAAM,CAAC,WAAW,CAAE,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC,eAAe,CAAE,QAAQ,GAAG,CAAC,EAAE,SAAS,GAAG,CAAC,EAAE,CAAC,CAAE,CAAE,CAAC;;AAEjG,KAAI,CAAC,OAAO,GAAG,IAAI,KAAK,CAAC,IAAI,CAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,WAAW,CAAE,CAAC;AAC/D,KAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC;AAC5D,KAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC;;AAE9D,KAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;AAClC,KAAI,CAAC,QAAQ,CAAC,GAAG,CAAE,IAAI,CAAC,OAAO,CAAE,CAAC;CAElC;;AAID,GAAG,CAAC,SAAS,GAAG;;AAEf,gBAAe,EAAE,yBAAW,MAAM,EAAG;;AAEpC,MAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,GAAG,MAAM,CAAC;EAElD;;AAED,OAAM,EAAE,kBAAY;;AAEnB,MAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;AAC3B,MAAI,CAAC,QAAQ,CAAC,MAAM,CAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAE,CAAC;EAEnD;;AAED,OAAM,EAAE,kBAAY;;;;AAGnB,MAAI,CAAC,MAAM,CAAC,IAAI,GAAG,CAAC,YAAY,CAAC;AACjC,MAAI,CAAC,MAAM,CAAC,KAAK,GAAG,YAAY,CAAC;;AAEjC,MAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC;AAC5D,MAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC;;AAE9D,MAAI,CAAC,MAAM,CAAC,sBAAsB,EAAE,CAAC;EAErC;;CAED,CAAC;ACpEF,YAAY,CAAC;;AAEb,SAAS,cAAc,CAAE,WAAW,EAAG;;AAEtC,KAAI,CAAC,UAAU,GAAG,WAAW,CAAC;AAC9B,KAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC;;AAEtC,KAAI,CAAC,IAAI,GAAG,IAAI,KAAK,CAAC,cAAc,EAAE,CAAC;;AAEvC,KAAI,CAAC,QAAQ,GAAG,IAAI,YAAY,CAAE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,GAAG,CAAC,CAAE,CAAC;AAC1E,KAAI,CAAC,IAAI,GAAG,OAAO,CAAE,IAAI,YAAY,CAAE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,GAAG,CAAC,CAAE,EAAE,CAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,EAAE,CAAC,CAAE,CAAE,CAAC;;AAE1H,KAAI,iBAAiB,GAAG,CAAG,GAAG,IAAI,CAAC,UAAU,CAAC;AAC9C,KAAI,mBAAmB,GAAG,GAAG,GAAG,IAAI,CAAC,UAAU,CAAC;AAChD,MAAM,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC,EAAE,EAAG;AAC3C,OAAM,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC,EAAE,EAAG;;AAE3C,OAAI,CAAC,IAAI,CAAC,GAAG,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAG,GAAG,iBAAiB,GAAG,CAAC,GAAG,mBAAmB,CAAE,CAAC;AAC5E,OAAI,CAAC,IAAI,CAAC,GAAG,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAG,GAAG,iBAAiB,GAAG,CAAC,GAAG,mBAAmB,CAAE,CAAC;AAC5E,OAAI,CAAC,IAAI,CAAC,GAAG,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAG,CAAE,CAAC;GAE9B;EACD;;AAED,KAAI,CAAC,IAAI,CAAC,YAAY,CAAE,MAAM,EAAE,IAAI,KAAK,CAAC,eAAe,CAAE,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAE,CAAE,CAAC;AACjF,KAAI,CAAC,IAAI,CAAC,YAAY,CAAE,UAAU,EAAE,IAAI,KAAK,CAAC,eAAe,CAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAE,CAAE,CAAC;;AAEpF,QAAO,IAAI,CAAC,IAAI,CAAC;AACjB,QAAO,IAAI,CAAC,QAAQ,CAAC;;AAErB,KAAI,CAAC,MAAM,GAAG,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;;AAEhC,KAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,cAAc,CAAE;;AAEzC,YAAU,EAAE;AACX,OAAI,EAAE;AACL,QAAI,EAAE,IAAI;AACV,SAAK,EAAE,IAAI;IACX;GACD;;AAED,UAAQ,EAAE;AACT,OAAI,EAAE;AACL,QAAI,EAAE,GAAG;AACT,SAAK,EAAE,CAAG;IACV;AACD,kBAAe,EAAE;AAChB,QAAI,EAAE,GAAG;AACT,SAAK,EAAE,QAAQ,CAAC,QAAQ;IACxB;AACD,iBAAc,EAAE;AACf,QAAI,EAAE,GAAG;AACT,SAAK,EAAE,IAAI;IACX;AACD,iBAAc,EAAE;AACf,QAAI,EAAE,GAAG;AACT,SAAK,EAAE,IAAI;IACX;AACD,aAAU,EAAE;AACX,QAAI,EAAE,GAAG;AACT,SAAK,EAAE,IAAI;IACX;AACD,cAAW,EAAE;AACZ,QAAI,EAAE,IAAI;AACV,SAAK,EAAE,IAAI;IACX;AACD,YAAS,EAAE;AACV,QAAI,EAAE,GAAG;AACT,SAAK,EAAE,CAAC,CAAC;IACT;GACD;;AAED,cAAY,EAAE,OAAO,CAAC,YAAY;AAClC,gBAAc,EAAE,OAAO,CAAC,YAAY;;AAEpC,aAAW,EAAE,IAAI;AACjB,WAAS,EAAE,KAAK;AAChB,YAAU,EAAE,KAAK;;;;;;;;;;AAWjB,UAAQ,EAAE,KAAK,CAAC,cAAc;AAC9B,eAAa,EAAE,KAAK,CAAC,WAAW;AAChC,UAAQ,EAAE,IAAI;AACd,UAAQ,EAAE,IAAI;;EAId,CAAE,CAAC;;AAEJ,KAAI,CAAC,YAAY,GAAG,IAAI,KAAK,CAAC,UAAU,CAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAE,CAAC;AACrE,KAAI,CAAC,YAAY,CAAC,aAAa,GAAG,KAAK,CAAC;CAExC;;AAED,cAAc,CAAC,SAAS,GAAG;;AAG1B,kBAAiB,EAAE,2BAAW,WAAW,EAAG;;AAE3C,MAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,cAAc,CAAC,KAAK,GAAG,WAAW,CAAC;EAE1D;;AAED,wBAAuB,EAAE,mCAAY;;AAEpC,MAAI,IAAI,GAAG,IAAI,YAAY,CAAE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,GAAG,CAAC,CAAE,CAAC;;AAErE,MAAI,SAAS,GAAG,EAAI,CAAC;;AAErB,OAAM,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAG;;AAE1C,OAAI,CAAE,CAAC,GAAG,CAAC,CAAE,GAAG,KAAK,CAAC,IAAI,CAAC,SAAS,CAAE,CAAC,SAAS,EAAE,SAAS,CAAE,CAAC;AAC9D,OAAI,CAAE,CAAC,GAAG,CAAC,CAAE,GAAG,KAAK,CAAC,IAAI,CAAC,SAAS,CAAE,CAAC,SAAS,EAAE,SAAS,CAAE,CAAC;AAC9D,OAAI,CAAE,CAAC,GAAG,CAAC,CAAE,GAAG,KAAK,CAAC,IAAI,CAAC,SAAS,CAAE,CAAC,SAAS,EAAE,SAAS,CAAE,CAAC;AAC9D,OAAI,CAAE,CAAC,GAAG,CAAC,CAAE,GAAG,KAAK,CAAC,IAAI,CAAC,SAAS,CAAE,CAAC,EAAE,EAAE,CAAE,CAAC;GAE9C;;AAED,MAAI,OAAO,GAAG,IAAI,KAAK,CAAC,WAAW,CAAE,IAAI,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,SAAS,CAAE,CAAC;AACjH,SAAO,CAAC,SAAS,GAAG,KAAK,CAAC,aAAa,CAAC;AACxC,SAAO,CAAC,SAAS,GAAG,KAAK,CAAC,aAAa,CAAC;AACxC,SAAO,CAAC,WAAW,GAAG,IAAI,CAAC;;AAE3B,SAAO,OAAO,CAAC;EAEf;;;;AAKD,KAAI,EAAE,gBAAY;;;AAGjB,MAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,kBAAkB,CAAE,CAAC,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,EAAE,EAAE,IAAI,CAAE,CAAC;AAChF,MAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAE,CAAC;AAC1C,MAAI,CAAC,QAAQ,CAAC,OAAO,CAAE,CAAC,IAAI,CAAC,EAAE,GAAG,GAAG,CAAE,CAAC;AACxC,MAAI,CAAC,QAAQ,CAAC,iBAAiB,EAAE,CAAC;AAClC,MAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,UAAU,CAAE,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAE,CAAC;AACzE,MAAI,CAAC,QAAQ,CAAC,sBAAsB,EAAE,CAAC;;;;;;AAMvC,MAAI,CAAC,WAAW,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;AACvC,MAAI,CAAC,WAAW,CAAC,GAAG,CACnB,GAAG,EAAE,CAAG,EAAE,CAAG,EAAE,GAAG,EAClB,CAAG,EAAE,GAAG,EAAE,CAAG,EAAE,GAAG,EAClB,CAAG,EAAE,CAAG,EAAE,GAAG,EAAE,GAAG,EAClB,CAAG,EAAE,CAAG,EAAE,CAAG,EAAE,CAAG,CAClB,CAAC;AACF,MAAI,CAAC,WAAW,CAAC,QAAQ,CAAE,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAE,CAAC;AAC5D,MAAI,CAAC,WAAW,CAAC,QAAQ,CAAE,IAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAE,CAAC;;AAE9D,MAAI,CAAC,UAAU,GAAG,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;AACpC,MAAI,CAAC,UAAU,CAAC,GAAG,CAAE,IAAI,CAAC,YAAY,CAAE,CAAC;;AAEzC,MAAI,UAAU,GAAG,CAAG,CAAC;AACrB,MAAI,CAAC,UAAU,GAAG,IAAI,KAAK,CAAC,iBAAiB,CAAE,IAAI,CAAC,UAAU,GAAG,UAAU,EAAE,IAAI,CAAC,UAAU,GAAG,UAAU,EAAE;;AAE1G,QAAK,EAAE,KAAK,CAAC,mBAAmB;AAChC,QAAK,EAAE,KAAK,CAAC,mBAAmB;AAChC,YAAS,EAAE,KAAK,CAAC,aAAa;AAC9B,YAAS,EAAE,KAAK,CAAC,aAAa;AAC9B,SAAM,EAAE,KAAK,CAAC,UAAU;AACxB,OAAI,EAAE,KAAK,CAAC,SAAS;AACrB,gBAAa,EAAE,KAAK;AACpB,cAAW,EAAE,KAAK;;GAElB,CAAE,CAAC;;AAEJ,MAAI,CAAC,SAAS,GAAG,EAAE,CAAC;AACpB,MAAI,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;AAChD,MAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC;AAC9C,SAAO,CAAC,GAAG,CAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAE,CAAC;;AAE3C,MAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC;AAC5D,MAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC;;AAE1D,MAAI,CAAC,eAAe,GAAG,IAAI,KAAK,CAAC,cAAc,CAAE;;AAEhD,aAAU,EAAE;AACX,QAAI,EAAE;AACL,SAAI,EAAE,IAAI;AACV,UAAK,EAAE,IAAI;KACX;IACD;;AAED,WAAQ,EAAE;AACT,QAAI,EAAE;AACL,SAAI,EAAE,GAAG;AACT,UAAK,EAAE,CAAG;KACV;AACD,aAAS,EAAE;AACV,SAAI,EAAE,GAAG;AACT,UAAK,EAAE,EAAI;KACX;AACD,mBAAe,EAAE;AAChB,SAAI,EAAE,GAAG;AACT,UAAK,EAAE,QAAQ,CAAC,QAAQ;KACxB;AACD,kBAAc,EAAE;AACf,SAAI,EAAE,GAAG;AACT,UAAK,EAAE,IAAI;KACX;IACD;;AAED,eAAY,EAAE,OAAO,CAAC,cAAc;AACpC,iBAAc,EAAE,OAAO,CAAC,cAAc;;AAEtC,cAAW,EAAE,IAAI;AACjB,YAAS,EAAE,KAAK;AAChB,aAAU,EAAE,KAAK;;;AAGjB,WAAQ,EAAE,KAAK,CAAC,cAAc;AAC9B,gBAAa,EAAE,KAAK,CAAC,WAAW;;AAEhC,gBAAa,EAAE,KAAK,CAAC,cAAc;AACnC,gBAAa,EAAE,KAAK,CAAC,sBAAsB;;GAE3C,CAAE,CAAC;;AAEJ,MAAI,CAAC,MAAM,CAAC,GAAG,CAAE,IAAI,CAAC,YAAY,CAAE,CAAC;EAErC;;AAED,OAAM,EAAE,gBAAW,QAAQ,EAAE,MAAM,EAAG;;;AAGrC,UAAQ,CAAC,aAAa,CAAE,CAAG,EAAE,CAAG,CAAE,CAAC;AACnC,UAAQ,CAAC,WAAW,CAAE,IAAI,CAAC,UAAU,CAAE,CAAC;AACxC,UAAQ,CAAC,aAAa,CAAE,cAAc,CAAC,OAAO,EAAE,CAAG,CAAE,CAAC;;;AAItD,OAAM,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC,EAAE,EAAG;;;AAG1C,OAAI,CAAC,IAAI,CAAC,SAAS,CAAE,CAAC,CAAE,GAAG;AAC1B,SAAK,EAAE,CAAC;AACR,SAAK,EAAE,IAAI,CAAC,SAAS;AACrB,SAAK,EAAE,CAAC,GAAG,IAAI,CAAC,SAAS;IACzB,CAAC;;;AAGF,OAAI,CAAC,YAAY,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;AAC3C,WAAQ,CAAC,MAAM,CAAE,IAAI,CAAC,MAAM,EAAE,MAAM,CAAE,CAAC;;;AAGvC,OAAI,CAAC,eAAe,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;AACvD,OAAI,CAAC,YAAY,CAAC,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC;AAClD,WAAQ,CAAC,MAAM,CAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,UAAU,CAAE,CAAC;GAE/D;;;AAGD,UAAQ,CAAC,eAAe,CAAE,IAAI,CAAC,iBAAiB,CAAE,CAAC;EAEnD;;AAED,iBAAgB,EAAE,0BAAU,MAAM,EAAG;;AAEpC,MAAI,GAAG,GAAG,IAAI,KAAK,CAAC,OAAO,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAE,CAAC;AACxC,MAAI,KAAK,GAAG,IAAI,KAAK,CAAC,OAAO,CAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAE,CAAC;AAC1C,MAAI,EAAE,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;;AAE7B,KAAG,CAAC,eAAe,CAAE,MAAM,CAAC,UAAU,CAAE,CAAC;AACzC,KAAG,CAAC,SAAS,EAAE,CAAC;AAChB,OAAK,CAAC,SAAS,EAAE,CAAC;;AAElB,MAAK,GAAG,CAAC,GAAG,CAAE,KAAK,CAAE,GAAG,CAAG,EAAG;;AAE7B,KAAE,CAAC,UAAU,CAAE,GAAG,EAAE,KAAK,CAAE,CAAC;AAC5B,OAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,KAAK,CAAC,SAAS,CAAA;AACxC,OAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,KAAK,CAAC,sBAAsB,CAAA;GAErD,MAAM;;AAEN,MAAG,CAAC,cAAc,CAAE,CAAC,CAAC,CAAE,CAAC;AACzB,KAAE,CAAC,UAAU,CAAE,GAAG,EAAE,KAAK,CAAE,CAAC;AAC5B,OAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,KAAK,CAAC,sBAAsB,CAAA;AACrD,OAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,KAAK,CAAC,SAAS,CAAA;GAExC;;AAED,IAAE,CAAC,SAAS,EAAE,CAAC;AACf,MAAI,CAAC,SAAS,GAAG,EAAE,CAAC;;AAEpB,SAAO,EAAE,CAAC;EAEV;;CAED,CAAC;AC7SF,YAAY,CAAC;;AAEb,SAAS,IAAI,GAAG;;AAEf,mBAAkB,EAAE,CAAC;;AAErB,GAAE,CAAC,GAAG,GAAG,IAAI,GAAG,CAAE,QAAQ,CAAE,CAAC;;AAE7B,eAAc,EAAE,CAAC;;AAEjB,QAAO,EAAE,CAAC;CAEV;;AAGD,SAAS,kBAAkB,GAAG;;AAE7B,GAAE,CAAC,aAAa,GAAG;AAClB,MAAI,EAAO,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,CAAG,EAAE;AACpC,UAAQ,EAAG,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE;AACrC,WAAS,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE;AACpC,OAAK,EAAM,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,EAAI,EAAE;EACrC,CAAC;;AAEF,GAAE,CAAC,YAAY,GAAG;AACjB,MAAI,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,CAAC,EAAE;AAC9B,OAAK,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,CAAC,EAAE;AAC/B,QAAM,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,KAAK,CAAC,OAAO,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAE,EAAE;AAC5D,WAAS,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,KAAK,CAAC,OAAO,EAAE,EAAE;AACrD,WAAS,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE;EAClC,CAAC;;AAGF,KAAI,QAAQ,GAAG,GAAG,CAAC;AACnB,GAAE,CAAC,IAAI,GAAG,IAAI,aAAa,CAAE,QAAQ,EAAE,QAAQ,EAAE,OAAO,CAAC,QAAQ,CAAE,CAAC;AACpE,GAAE,CAAC,IAAI,CAAC,OAAO,CAAE,cAAc,EAAE,OAAO,CAAC,QAAQ,EAAE,EAAE,cAAc,EAAE,cAAc,EAAE,EAAE,EAAE,CAAC,aAAa,CAAE,CAAC;AAC1G,GAAE,CAAC,IAAI,CAAC,OAAO,CAAE,cAAc,EAAE,OAAO,CAAC,QAAQ,EAAE,EAAE,cAAc,EAAE,cAAc,EAAE,EAAE,EAAE,CAAC,aAAa,CAAE,CAAC;AAC1G,GAAE,CAAC,IAAI,CAAC,OAAO,CAAE,UAAU,EAAE,OAAO,CAAC,IAAI,EAAE,EAAE,EAAE,EAAE,CAAC,YAAY,CAAE,CAAC;;AAEjE,GAAE,CAAC,IAAI,GAAG,IAAI,cAAc,CAAE,QAAQ,CAAE,CAAC;AACzC,GAAE,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;;AAEf,KAAI,0BAA0B,GAAG,EAAE,CAAC,IAAI,CAAC,uBAAuB,EAAE,CAAC;AACnE,GAAE,CAAC,IAAI,CAAC,mBAAmB,CAAE,0BAA0B,EAAE,cAAc,CAAE,CAAC;CAE1E;;AAED,SAAS,cAAc,GAAG;;AAEzB,GAAE,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC,mBAAmB,CAAE,CAAC,EAAE,CAAC,CAAE,CAAC;AACjD,GAAE,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC,iBAAiB,CAAE;;AAEvC,OAAK,EAAE,cAAc,CAAC,OAAO;AAC7B,MAAI,EAAE,KAAK,CAAC,UAAU;AACtB,aAAW,EAAE,IAAI;;AAEjB,UAAQ,EAAE,KAAK,CAAC,cAAc;AAC9B,eAAa,EAAE,KAAK,CAAC,WAAW;AAChC,UAAQ,EAAE,KAAK,CAAC,sBAAsB;AACtC,UAAQ,EAAE,KAAK,CAAC,SAAS;;EAEzB,CAAE,CAAC;AACJ,GAAE,CAAC,MAAM,GAAG,IAAI,KAAK,CAAC,IAAI,CAAE,EAAE,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAE,CAAC;AACjD,GAAE,CAAC,OAAO,GAAG,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;AAC/B,GAAE,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC;AAC9B,GAAE,CAAC,OAAO,CAAC,GAAG,CAAE,EAAE,CAAC,MAAM,CAAE,CAAC;CAE5B;;;;;AC/DD,YAAY,CAAC;;AAEb,SAAS,MAAM,GAAG;;AAEjB,GAAE,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC,cAAc,EAAE,CAAC;;AAErD,GAAE,CAAC,IAAI,CAAC,gBAAgB,CAAE,MAAM,CAAE,CAAC;AACnC,GAAE,CAAC,YAAY,CAAC,SAAS,CAAC,KAAK,GAAG,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC;AACpD,GAAE,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;AACf,GAAE,CAAC,IAAI,CAAC,iBAAiB,CAAE,EAAE,CAAC,IAAI,CAAC,OAAO,CAAE,UAAU,CAAE,CAAC,eAAe,EAAE,CAAE,CAAC;;AAE7E,iBAAgB,EAAE,CAAC;CAEnB;;;AAID,SAAS,GAAG,GAAG;;AAEd,sBAAqB,CAAE,GAAG,CAAE,CAAC;;AAE7B,SAAQ,CAAC,aAAa,CAAE,CAAC,EAAE,CAAG,CAAE,CAAC;AACjC,SAAQ,CAAC,KAAK,EAAE,CAAC;;AAEjB,KAAK,CAAC,cAAc,CAAC,KAAK,EAAG;AAC5B,QAAM,EAAE,CAAC;EACT;;AAED,SAAQ,CAAC,MAAM,CAAE,KAAK,EAAE,MAAM,CAAE,CAAC;;AAEjC,GAAE,CAAC,IAAI,CAAC,MAAM,CAAE,QAAQ,EAAE,MAAM,CAAE,CAAC;;AAEnC,SAAQ,CAAC,MAAM,CAAE,EAAE,CAAC,OAAO,EAAE,EAAE,CAAC,KAAK,CAAE,CAAC;;AAExC,KAAK,cAAc,CAAC,eAAe,EAAG;AACrC,IAAE,CAAC,GAAG,CAAC,eAAe,CAAE,EAAE,CAAC,IAAI,CAAC,UAAU,CAAE,CAAC;AAC7C,IAAE,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC;EAChB;;AAED,MAAK,CAAC,MAAM,EAAE,CAAC;CAEf;AC7CD,YAAY,CAAC;;AAEb,MAAM,CAAC,gBAAgB,CAAE,UAAU,EAAE,UAAE,KAAK,EAAM;;AAEjD,KAAI,GAAG,GAAG,KAAK,CAAC,OAAO,CAAC;;AAExB,SAAQ,GAAG;;AAEV,OAAK,EAAE;AAAE,iBAAc,CAAC,KAAK,GAAG,CAAC,cAAc,CAAC,KAAK,CAAC;AACtD,SAAM;;AAAA,AAEN,OAAK,EAAE,CAAC;AACR,OAAK,EAAE;QAAO,cAAc,CAAC,gBAAgB,GAAG,CAAC,cAAc,CAAC,gBAAgB,CAAC,AAAC,aAAa,EAAE,CAAC;AAClG,SAAM;;AAAA,AAEN,OAAK,EAAE,CAAE;AACT,OAAK,GAAG;QAAO,cAAc,CAAC,gBAAgB,GAAG,CAAC,cAAc,CAAC,gBAAgB,CAAC,AAAC,aAAa,EAAE,CAAC;AACnG,SAAM;;AAAA,EAEN;CAED,CAAE,CAAC;;AAGJ,MAAM,CAAC,gBAAgB,CAAE,QAAQ,EAAE,QAAQ,CAAE,cAAc,EAAE,GAAG,CAAE,CAAE,CAAC;;AAErE,SAAS,cAAc,GAAG;;AAEzB,MAAK,GAAG,MAAM,CAAC,UAAU,CAAC;AAC1B,OAAM,GAAG,MAAM,CAAC,WAAW,CAAC;;AAE5B,YAAW,GAAG,MAAM,CAAC,iBAAiB,IAAI,CAAC,CAAC;AAC5C,aAAY,GAAG,KAAK,GAAG,MAAM,CAAC;;AAE9B,OAAM,CAAC,MAAM,GAAG,YAAY,CAAC;AAC7B,OAAM,CAAC,sBAAsB,EAAE,CAAC;;AAEhC,SAAQ,CAAC,OAAO,CAAE,KAAK,EAAE,MAAM,CAAE,CAAC;AAClC,SAAQ,CAAC,aAAa,CAAE,WAAW,CAAE,CAAC;;AAEtC,GAAE,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC;CAEhB;;;ACzCD,SAAS,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE;;;;AAExC,KAAI,OAAO,CAAC;AACZ,QAAO,YAAM;;AAEZ,MAAI,OAAO,QAAO;MAAE,IAAI,aAAY,CAAC;AACrC,MAAI,KAAK,GAAG,SAAR,KAAK,GAAS;;AAEjB,UAAO,GAAG,IAAI,CAAC;AACf,OAAI,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;GAE1C,CAAC;AACF,MAAI,OAAO,GAAG,SAAS,IAAI,CAAC,OAAO,CAAC;AACpC,cAAY,CAAC,OAAO,CAAC,CAAC;AACtB,SAAO,GAAG,UAAU,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;AAClC,MAAI,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;EAEvC,CAAC;CAEF","file":"app.min.js","sourcesContent":["'use strict';\nvar loadingManager = new THREE.LoadingManager();\nloadingManager.onLoad = () => {\n\n\tmain();\n\trun();\n\n};\n\nloadingManager.onProgress = ( item, loaded, total ) => {\n\n\tconsole.log( loaded + '/' + total, item );\n\n};\n\nvar SHADERS = {};\nvar shaderLoader = new THREE.XHRLoader( loadingManager );\nshaderLoader.setResponseType( 'text' );\nshaderLoader.showStatus = true;\n\nshaderLoader.loadShaders = ( SHADERS, urlObj ) => {\n\n\tObject.keys( urlObj ).forEach( ( key ) => {\n\n\t\tshaderLoader.load( urlObj[ key ], ( shader ) => {\n\n\t\t\tSHADERS[ key ] = shader;\n\n\t\t} );\n\n\t} );\n\n};\n\nshaderLoader.loadShaders( SHADERS, {\n\n\tpassVert: 'shaders/pass.vert',\n\tpassFrag: 'shaders/pass.frag',\n\n\thudVert: 'shaders/hud.vert',\n\thudFrag: 'shaders/hud.frag',\n\n\tparticleVert: 'shaders/particle.vert',\n\tparticleFrag: 'shaders/particle.frag',\n\n\tvelocity: 'shaders/velocity.frag',\n\tposition: 'shaders/position.frag',\n\n\tsort: 'shaders/mergeSort.frag',\n\n\topacityMapVert: 'shaders/opacityMap.vert',\n\topacityMapFrag: 'shaders/opacityMap.frag',\n\n\n} );\n\nvar TEXTURES = {};\nvar textureLoader = new THREE.TextureLoader( loadingManager );\ntextureLoader.load( 'sprites/electricScaled.png', ( tex ) => {\n\tTEXTURES.electric = tex;\n} );\n","'use strict';\n\nif ( !Detector.webgl ){\n\tDetector.addGetWebGLMessage();\n}\n\nvar $$ = {};\nvar CANVAS, STATS;\nvar SCENE, CAMERA, CAMERA_CTRL, RENDERER;\nvar WIDTH = window.innerWidth;\nvar HEIGHT = window.innerHeight;\nvar PIXEL_RATIO = window.devicePIXEL_RATIO || 1;\nvar SCREEN_RATIO = WIDTH / HEIGHT;\nvar CLOCK = new THREE.Clock();\n\n// ---- Settings\nvar SCENE_SETTINGS = {\n\n\tbgColor: 0x2d2d2d,\n\tpause: false,\n\tenableGridHelper: false,\n\tenableAxisHelper: false,\n\tshowFrameBuffer: true\n\n};\n\n// ---- Scene\n\tCANVAS = document.getElementById( 'canvas' );\n\tSCENE = new THREE.Scene();\n\n// ---- Camera\n\tCAMERA = new THREE.PerspectiveCamera( 70, SCREEN_RATIO, 10, 100000 );\n\tCAMERA_CTRL = new THREE.OrbitControls( CAMERA, CANVAS );\n\tCAMERA.position.set( -321.5847028300089, 215.28711637817776, 881.9719256352606 );\n\tCAMERA.quaternion.set( -0.12170374143462927, -0.340052864691943, 0.04443202001754455, 0.9314386960684689 );\n\tCAMERA_CTRL.center.set( 243.27711348462407, -17.799729328901254, 211.47633089038425 );\n\tCAMERA_CTRL.update();\n\n// ---- Renderer\n\tRENDERER = new THREE.WebGLRenderer( { antialias: false , alpha: true } );\n\tRENDERER.setSize( WIDTH, HEIGHT );\n\tRENDERER.setPixelRatio( PIXEL_RATIO );\n\tRENDERER.setClearColor( SCENE_SETTINGS.bgColor, 1.0 );\n\tRENDERER.autoClear = false;\n\n\tCANVAS.appendChild( RENDERER.domElement );\n\n// ---- Stats\n\tSTATS = new Stats();\n\tCANVAS.appendChild( STATS.domElement );\n\n// ---- grid & axis helper\n\tvar gridHelper = new THREE.GridHelper( 600, 50 );\n\tgridHelper.setColors( 0 );\n\tgridHelper.material.opacity = 0.5;\n\tgridHelper.material.transparent = true;\n\tgridHelper.position.y = -300;\n\tSCENE.add( gridHelper );\n\n\tvar axisHelper = new THREE.AxisHelper( 1000 );\n\tSCENE.add( axisHelper );\n\n\tfunction updateHelpers() {\n\t\taxisHelper.visible = SCENE_SETTINGS.enableAxisHelper;\n\t\tgridHelper.visible = SCENE_SETTINGS.enableGridHelper;\n\t}\n\tupdateHelpers();\n","'use strict';\n\nvar gui, gui_display, gui_settings;\n\nfunction initGui() {\n\n\t// gui_settings.add( Object, property, min, max, step ).name( 'name' );\n\n\tgui = new dat.GUI();\n\tgui.width = 300;\n\n\tgui_display = gui.addFolder( 'Display' );\n\t\tgui_display.autoListen = false;\n\n\tgui_settings = gui.addFolder( 'Settings' );\n\n\t\tgui_settings.addColor( SCENE_SETTINGS, 'bgColor' ).name( 'Background' );\n\t\tgui_settings.add( CAMERA, 'fov', 25, 120, 1 ).name( 'FOV' );\n\n\t\tgui_settings.add( $$.uniformsInput.timeMult, 'value', 0.0, 0.5  , 0.01 ).name( 'Time Multiplier' );\n\t\tgui_settings.add( $$.uniformsInput.noiseFreq, 'value', 0.0, 3.0  , 0.01 ).name( 'Frequency' );\n\t\tgui_settings.add( $$.uniformsInput.speed, 'value', 0.0, 200.0, 0.01 ).name( 'Speed' );\n\t\tgui_settings.add( $$.psys.material.uniforms.size, 'value', 1.0, 20.0 , 0.01 ).name( 'Size' );\n\t\tgui_settings.add( SCENE_SETTINGS, 'showFrameBuffer' ).name( 'Show Frame Buffer' );\n\n\n\tgui_display.open();\n\tgui_settings.open();\n\n\tgui_settings.__controllers.forEach( ( controller ) => {\n\t\tcontroller.onChange( updateSettings );\n\t} );\n\n}\n\nfunction updateSettings() {\n\n\tCAMERA.updateProjectionMatrix();\n\t$$.bgMat.color.setHex( SCENE_SETTINGS.bgColor );\n\t// renderer.setClearColor( SCENE_SETTINGS.bgColor , 1.0 );\n\n}\n\nfunction updateGuiDisplay() {\n\n\tgui_display.__controllers.forEach( ( controller ) => {\n\t\tcontroller.updateDisplay();\n\t} );\n\n}\n","'use strict';\n\nfunction FBOCompositor( renderer, bufferSize, passThruVertexShader ) {\n\n\tthis.renderer = renderer;\n\n\tthis._getWebGLExtensions();\n\tthis.bufferSize = bufferSize;\n\tthis.passThruVertexShader = passThruVertexShader;\n\tvar halfBufferSize = bufferSize * 0.5;\n\tthis.camera = new THREE.OrthographicCamera( -halfBufferSize, halfBufferSize, halfBufferSize, -halfBufferSize, 1, 10 );\n\tthis.camera.position.z = 5;\n\tthis.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );\n\tthis.scene = new THREE.Scene();\n\tthis.scene.add( this.quad );\n\tthis.dummyRenderTarget = new THREE.WebGLRenderTarget( 2, 2 );\n\n\tthis.passThruShader = new THREE.ShaderMaterial( {\n\n\t\tuniforms: {\n\t\t\tresolution: {\n\t\t\t\ttype: 'v2',\n\t\t\t\tvalue: new THREE.Vector2( this.bufferSize, this.bufferSize )\n\t\t\t},\n\t\t\tpassTexture: {\n\t\t\t\ttype: 't',\n\t\t\t\tvalue: null\n\t\t\t}\n\t\t},\n\t\tvertexShader: SHADERS.passVert,\n\t\tfragmentShader: SHADERS.passFrag,\n\t\tblending: THREE.NoBlending\n\n\t} );\n\n\tthis.passes = [];\n\n\t// sorting\n\tthis.totalSortStep = ( Math.log2( this.bufferSize*this.bufferSize ) * ( Math.log2( this.bufferSize * this.bufferSize ) + 1 ) ) / 2;\n\tconsole.log( this.totalSortStep );\n\tthis.sortPass = -1;\n\tthis.sortStage = -1;\n\n}\n\nFBOCompositor.prototype = {\n\n\t_getWebGLExtensions: function () {\n\n\t\tvar gl = this.renderer.getContext();\n\t\tif ( !gl.getExtension( \"OES_texture_float\" ) ) {\n\t\t\tconsole.error( \"No support for float textures!\" );\n\t\t}\n\n\t\tif ( gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS ) === 0 ) {\n\t\t\tconsole.error( \"No support for vertex shader textures!\" );\n\t\t}\n\n\t},\n\n\tgetPass: function ( name ) {\n\t\t/* todo: update to ES6 Array.find() */\n\t\tvar pass = null;\n\t\tthis.passes.some( function ( currPass ) {\n\n\t\t\tvar test = currPass.name === name;\n\t\t\tif ( test ) pass = currPass;\n\t\t\treturn test;\n\n\t\t} );\n\n\t\treturn pass;\n\n\t},\n\n\taddPass: function ( name, fragmentShader, inputTargets, uniforms ) {\n\n\t\tvar pass = new FBOPass( name, this.passThruVertexShader, fragmentShader, this.bufferSize );\n\t\tpass.inputTargetList = inputTargets  || {};\n\t\tpass.attachUniform( uniforms || {} );\n\t\tthis.passes.push( pass );\n\t\treturn pass;\n\n\t},\n\n\tupdatePassDependencies: function () {\n\n\t\tvar self = this;\n\t\tthis.passes.forEach( function ( currPass ) {\n\n\t\t\tObject.keys( currPass.inputTargetList ).forEach( function ( shaderInputName ) {\n\n\t\t\t\tvar targetPass = currPass.inputTargetList[ shaderInputName ];\n\t\t\t\tcurrPass.setInputTarget( shaderInputName, self.getPass( targetPass ).getRenderTarget() );\n\n\t\t\t} );\n\n\t\t} );\n\n\t},\n\n\t_renderPass: function ( shader, passTarget ) {\n\n\t\tthis.quad.material = shader;\n\t\tthis.renderer.render( this.scene, this.camera, passTarget, true );\n\n\t},\n\n\trenderInitialBuffer: function ( dataTexture, toPass ) {\n\n\t\tvar pass = this.getPass( toPass );\n\t\tthis.passThruShader.uniforms.passTexture.value = dataTexture;\n\t\tthis._renderPass( this.passThruShader, pass.doubleBuffer[ 1 ] ); // render to secondary buffer which is already set as input to first buffer.\n\t\tthis._renderPass( this.passThruShader, pass.doubleBuffer[ 0 ] ); // or just render to both\n\t\t/*!\n\t\t *\tdont call renderer.clear() before updating the simulation it will clear current active buffer which is the render target that we previously rendered to.\n\t\t *\tor just set active target to dummy target.\n\t\t */\n\t\tthis.renderer.setRenderTarget( this.dummyRenderTarget );\n\n\t},\n\n\tstep: function () {\n\n\t\tfor ( let i = 0; i < this.passes.length; i++ ) {\n\n\t\t\tthis.updatePassDependencies();\n\t\t\tvar currPass = this.passes[ i ];\n\n\t\t\tif ( currPass.name === 'sortPass' ) {\n\n\t\t\t\t// copy position buffer to sort buffer\n\t\t\t\tthis.renderInitialBuffer( this.getPass( 'positionPass' ).getRenderTarget(), currPass.name );\n\n\t\t\t\tfor ( let s = 0; s <= this.totalSortStep; s ++ ) {\n\n\t\t\t\t\tthis.sortPass --;\n\t\t\t      if ( this.sortPass  < 0 ) {\n\t\t\t\t\t\tthis.sortStage ++;\n\t\t\t\t\t\tthis.sortPass = this.sortStage;\n\t\t\t      }\n\n\t\t\t\t\tcurrPass.uniforms.pass.value  = 1 << this.sortPass;\n\t\t\t\t\tcurrPass.uniforms.stage.value = 1 << this.sortStage;\n\n\t\t\t\t\t// console.log( 'Stage:', this.sortStage, 1 << this.sortStage );\n\t\t\t\t\t// console.log( 'Pass:', this.sortPass, 1 << this.sortPass );\n\t\t\t\t\t// console.log( '------------------------------------------' );\n\n\t\t\t\t\tthis._renderPass( currPass.getShader(), currPass.getRenderTarget() );\n\t\t\t\t\tcurrPass.swapBuffer();\n\n\t\t\t\t}\n\n\t\t\t\t// reset\n\t\t\t\tthis.sortPass = -1;\n\t\t\t\tthis.sortStage = -1;\n\n\t\t\t} else {\n\n\t\t\t\t// other passes\n\t\t\t\tthis._renderPass( currPass.getShader(), currPass.getRenderTarget() );\n\t\t\t\tcurrPass.swapBuffer();\n\n\t\t\t}\n\n\t\t} // end loop\n\n\t}\n\n};\n\n\nfunction FBOPass( name, vertexShader, fragmentShader, bufferSize ) {\n\n\tthis.name = name;\n\tthis.vertexShader = vertexShader;\n\tthis.fragmentShader = fragmentShader;\n\tthis.bufferSize = bufferSize;\n\n\tthis.currentBuffer = 0;\n\tthis.doubleBuffer = []; //  single FBO cannot act as input (texture) and output (render target) at the same time, we take the double-buffer approach\n\tthis.doubleBuffer[ 0 ] = this.generateRenderTarget();\n\tthis.doubleBuffer[ 1 ] = this.generateRenderTarget();\n\n\tthis.inputTargetList = {};\n\n\tthis.uniforms = {\n\t\tresolution: {\n\t\t\ttype: 'v2',\n\t\t\tvalue: new THREE.Vector2( this.bufferSize, this.bufferSize )\n\t\t},\n\t\tmirrorBuffer: {\n\t\t\ttype: 't',\n\t\t\tvalue: this.doubleBuffer[ 1 ]\n\t\t}\n\t};\n\n\tthis.shader = new THREE.ShaderMaterial( {\n\n\t\tuniforms: this.uniforms,\n\t\tvertexShader: this.vertexShader,\n\t\tfragmentShader: this.fragmentShader,\n\t\tblending: THREE.NoBlending\n\n\t} );\n\n}\n\nFBOPass.prototype = {\n\n\tgetShader: function () {\n\t\treturn this.shader;\n\t},\n\tgetRenderTarget: function () {\n\t\treturn this.doubleBuffer[ this.currentBuffer ];\n\t},\n\tsetInputTarget: function ( shaderInputName, inputTarget ) {\n\t\tthis.uniforms[ shaderInputName ] = {\n\t\t\ttype: 't',\n\t\t\tvalue: inputTarget\n\t\t};\n\t},\n\tswapBuffer: function () {\n\n\t\tthis.uniforms.mirrorBuffer.value = this.doubleBuffer[ this.currentBuffer ];\n\t\tthis.currentBuffer ^= 1;\n\n\t},\n\tgenerateRenderTarget: function () {\n\n\t\tvar target = new THREE.WebGLRenderTarget( this.bufferSize, this.bufferSize, {\n\n\t\t\twrapS: THREE.ClampToEdgeWrapping,\n\t\t\twrapT: THREE.ClampToEdgeWrapping,\n\t\t\tminFilter: THREE.NearestFilter,\n\t\t\tmagFilter: THREE.NearestFilter,\n\t\t\tformat: THREE.RGBAFormat,\n\t\t\ttype: THREE.FloatType,\n\t\t\tstencilBuffer: false,\n\t\t\tdepthBuffer: false,\n\n\t\t} );\n\n\t\treturn target;\n\n\t},\n\tattachUniform: function ( uniformsInput ) {\n\n\t\tvar self = this;\n\t\tObject.keys( uniformsInput ).forEach( function ( key ) {\n\n\t\t\tself.uniforms[ key ] = uniformsInput[ key ];\n\n\t\t} );\n\n\t},\n\n};\n","'use strict';\n\nfunction HUD( renderer ) {\n\n\tthis.renderer = renderer;\n\tthis.HUDMargin = 0.05;\n\tvar hudHeight = 2.0 / 3.0; // 2.0 = full screen size\n\tvar hudWidth = hudHeight;\n\n\tthis.HUDCam = new THREE.OrthographicCamera( -SCREEN_RATIO, SCREEN_RATIO, 1, -1, 1, 10 );\n\tthis.HUDCam.position.z = 5;\n\n\tthis.hudMaterial = new THREE.ShaderMaterial( {\n\n\t\tuniforms: {\n\t\t\ttDiffuse: {\n\t\t\t\ttype: \"t\",\n\t\t\t\tvalue: this.tTarget\n\t\t\t}\n\t\t},\n\t\tvertexShader: SHADERS.hudVert,\n\t\tfragmentShader: SHADERS.hudFrag\n\n\t} );\n\n\n\tthis.hudGeo = new THREE.PlaneBufferGeometry( hudWidth, hudHeight );\n\tthis.hudGeo.applyMatrix( new THREE.Matrix4().makeTranslation( hudWidth / 2, hudHeight / 2, 0 ) );\n\n\tthis.HUDMesh = new THREE.Mesh( this.hudGeo, this.hudMaterial );\n\tthis.HUDMesh.position.x = this.HUDCam.left + this.HUDMargin;\n\tthis.HUDMesh.position.y = this.HUDCam.bottom + this.HUDMargin;\n\n\tthis.HUDScene = new THREE.Scene();\n\tthis.HUDScene.add( this.HUDMesh );\n\n}\n\n\n\nHUD.prototype = {\n\n\tsetInputTexture: function ( target ) {\n\n\t\tthis.hudMaterial.uniforms.tDiffuse.value = target;\n\n\t},\n\n\trender: function () {\n\n\t\tthis.renderer.clearDepth();\n\t\tthis.renderer.render( this.HUDScene, this.HUDCam );\n\n\t},\n\n\tupdate: function () { // call on window resize\n\n\t\t// match aspect ratio to prevent distortion\n\t\tthis.HUDCam.left = -SCREEN_RATIO;\n\t\tthis.HUDCam.right = SCREEN_RATIO;\n\n\t\tthis.HUDMesh.position.x = this.HUDCam.left + this.HUDMargin;\n\t\tthis.HUDMesh.position.y = this.HUDCam.bottom + this.HUDMargin;\n\n\t\tthis.HUDCam.updateProjectionMatrix();\n\n\t}\n\n};\n","'use strict';\n\nfunction ParticleSystem( _bufferSize ) {\n\n\tthis.bufferSize = _bufferSize;\n\tthis.halfSize = this.bufferSize * 0.5;\n\n\tthis.geom = new THREE.BufferGeometry();\n\n\tthis.position = new Float32Array( this.bufferSize * this.bufferSize * 3 );\n\tthis.ndUV = ndarray( new Float32Array( this.bufferSize * this.bufferSize * 3 ), [ this.bufferSize, this.bufferSize, 3 ] );\n\n\tvar normalizedSpacing = 1.0 / this.bufferSize;\n\tvar normalizedHalfPixel = 0.5 / this.bufferSize;\n\tfor ( let r = 0; r < this.bufferSize; r++ ) {\n\t\tfor ( let c = 0; c < this.bufferSize; c++ ) {\n\n\t\t\tthis.ndUV.set( r, c, 0, 1.0 - normalizedSpacing * c + normalizedHalfPixel );\n\t\t\tthis.ndUV.set( r, c, 1, 1.0 - normalizedSpacing * r + normalizedHalfPixel );\n\t\t\tthis.ndUV.set( r, c, 2, 0.0 );\n\n\t\t}\n\t}\n\n\tthis.geom.addAttribute( 'here', new THREE.BufferAttribute( this.ndUV.data, 3 ) );\n\tthis.geom.addAttribute( 'position', new THREE.BufferAttribute( this.position, 3 ) );\n\n\tdelete this.ndUV;\n\tdelete this.position;\n\n\tthis.pScene = new THREE.Scene();\n\n\tthis.material = new THREE.ShaderMaterial( {\n\n\t\tattributes: {\n\t\t\there: {\n\t\t\t\ttype: 'v3',\n\t\t\t\tvalue: null\n\t\t\t}\n\t\t},\n\n\t\tuniforms: {\n\t\t\tsize: {\n\t\t\t\ttype: 'f',\n\t\t\t\tvalue: 3.0\n\t\t\t},\n\t\t\tparticleTexture: {\n\t\t\t\ttype: 't',\n\t\t\t\tvalue: TEXTURES.electric\n\t\t\t},\n\t\t\tpositionBuffer: {\n\t\t\t\ttype: 't',\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tvelocityBuffer: {\n\t\t\t\ttype: 't',\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\topacityMap: {\n\t\t\t\ttype: 't',\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tlightMatrix: {\n\t\t\t\ttype: 'm4',\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tsortOrder: {\n\t\t\t\ttype: 'f',\n\t\t\t\tvalue: -1\n\t\t\t}\n\t\t},\n\n\t\tvertexShader: SHADERS.particleVert,\n\t\tfragmentShader: SHADERS.particleFrag,\n\n\t\ttransparent: true,\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\n\t\t/* blend modes override in run time\n\t\t\tback to front\n\t\t\tTHREE.OneFactor,\n\t\t\tTHREE.OneMinusSrcAlphaFactor,\n\n\t\t\tfront to back\n\t\t\tTHREE.OneMinusDstAlphaFactor,\n\t\t\tTHREE.OneFactor,\n\t\t*/\n\t\tblending: THREE.CustomBlending,\n\t\tblendEquation: THREE.AddEquation,\n\t\tblendSrc: null,\n\t\tblendDst: null,\n\n\n\n\t} );\n\n\tthis.particleMesh = new THREE.PointCloud( this.geom, this.material );\n\tthis.particleMesh.frustumCulled = false;\n\n}\n\nParticleSystem.prototype = {\n\n\n\tsetPositionBuffer: function ( inputBuffer ) {\n\n\t\tthis.material.uniforms.positionBuffer.value = inputBuffer;\n\n\t},\n\n\tgeneratePositionTexture: function () {\n\n\t\tvar data = new Float32Array( this.bufferSize * this.bufferSize * 4 );\n\n\t\tvar fieldSize = 25.0;\n\n\t\tfor ( var i = 0; i < data.length; i += 4 ) {\n\n\t\t\tdata[ i + 0 ] = THREE.Math.randFloat( -fieldSize, fieldSize );\n\t\t\tdata[ i + 1 ] = THREE.Math.randFloat( -fieldSize, fieldSize );\n\t\t\tdata[ i + 2 ] = THREE.Math.randFloat( -fieldSize, fieldSize );\n\t\t\tdata[ i + 3 ] = THREE.Math.randFloat( 0, 50 ); // initial particle life, todo: move to separate texture\n\n\t\t}\n\n\t\tvar texture = new THREE.DataTexture( data, this.bufferSize, this.bufferSize, THREE.RGBAFormat, THREE.FloatType );\n\t\ttexture.minFilter = THREE.NearestFilter;\n\t\ttexture.magFilter = THREE.NearestFilter;\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t},\n\n\n\t// opacity map stuff\n\n\tinit: function () {\n\n\t\t// cam\n\t\tthis.lightCam = new THREE.OrthographicCamera( -600, 1000, 500, -500, 10, 1000 );\n\t\tthis.lightCam.position.set( 500, 500, 0 );\n\t\tthis.lightCam.rotateX( -Math.PI * 0.5 );\n\t\tthis.lightCam.updateMatrixWorld();\n\t\tthis.lightCam.matrixWorldInverse.getInverse( this.lightCam.matrixWorld );\n\t\tthis.lightCam.updateProjectionMatrix();\n\n\t\t// this.lightCamHelper = new THREE.CameraHelper( this.lightCam );\n\t\t// SCENE.add( this.lightCamHelper );\n\n\t\t// uniform -> lightMatrix\n\t\tthis.lightMatrix = new THREE.Matrix4();\n\t\tthis.lightMatrix.set(\n\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t);\n\t\tthis.lightMatrix.multiply( this.lightCam.projectionMatrix );\n\t\tthis.lightMatrix.multiply( this.lightCam.matrixWorldInverse );\n\n\t\tthis.lightScene = new THREE.Scene();\n\t\tthis.lightScene.add( this.particleMesh );\n\n\t\tvar downSample = 1.0;\n\t\tthis.opacityMap = new THREE.WebGLRenderTarget( this.bufferSize * downSample, this.bufferSize * downSample, {\n\n\t\t\twrapS: THREE.ClampToEdgeWrapping,\n\t\t\twrapT: THREE.ClampToEdgeWrapping,\n\t\t\tminFilter: THREE.NearestFilter,\n\t\t\tmagFilter: THREE.NearestFilter,\n\t\t\tformat: THREE.RGBAFormat,\n\t\t\ttype: THREE.FloatType,\n\t\t\tstencilBuffer: false,\n\t\t\tdepthBuffer: false,\n\n\t\t} );\n\n\t\tthis.numSlices = 32;\n\t\tthis.pCount = this.bufferSize * this.bufferSize;\n\t\tthis.pPerSlice = this.pCount / this.numSlices;\n\t\tconsole.log( this.pCount, this.pPerSlice );\n\n\t\tthis.material.uniforms.lightMatrix.value = this.lightMatrix;\n\t\tthis.material.uniforms.opacityMap.value = this.opacityMap;\n\n\t\tthis.opacityMaterial = new THREE.ShaderMaterial( {\n\n\t\t\tattributes: {\n\t\t\t\there: {\n\t\t\t\t\ttype: 'v3',\n\t\t\t\t\tvalue: null\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tuniforms: {\n\t\t\t\tsize: {\n\t\t\t\t\ttype: 'f',\n\t\t\t\t\tvalue: 3.0\n\t\t\t\t},\n\t\t\t\tluminance: {\n\t\t\t\t\ttype: 'f',\n\t\t\t\t\tvalue: 50.0\n\t\t\t\t},\n\t\t\t\tparticleTexture: {\n\t\t\t\t\ttype: 't',\n\t\t\t\t\tvalue: TEXTURES.electric\n\t\t\t\t},\n\t\t\t\tpositionBuffer: {\n\t\t\t\t\ttype: 't',\n\t\t\t\t\tvalue: null\n\t\t\t\t},\n\t\t\t},\n\n\t\t\tvertexShader: SHADERS.opacityMapVert,\n\t\t\tfragmentShader: SHADERS.opacityMapFrag,\n\n\t\t\ttransparent: true,\n\t\t\tdepthTest: false,\n\t\t\tdepthWrite: false,\n\n\t\t\t////\n\t\t\tblending: THREE.CustomBlending,\n\t\t\tblendEquation: THREE.AddEquation,\n\n\t\t\tblendSrcAlpha: THREE.SrcAlphaFactor,\n\t\t\tblendDstAlpha: THREE.OneMinusSrcAlphaFactor\n\n\t\t} );\n\n\t\tthis.pScene.add( this.particleMesh );\n\n\t},\n\n\trender: function ( renderer, camera ) {\n\n\t\t// clear opacityMap buffer\n\t\trenderer.setClearColor( 0.0, 1.0 );\n\t\trenderer.clearTarget( this.opacityMap );\n\t\trenderer.setClearColor( SCENE_SETTINGS.bgColor, 1.0 );\n\n\n\t\t// set position buffer\n\t\tfor ( let i = 0; i < this.numSlices; i++ ) {\n\n\t\t\t// set geometry draw calls\n\t\t\tthis.geom.drawcalls[ 0 ] = {\n\t\t\t\tstart: 0,\n\t\t\t\tcount: this.pPerSlice,\n\t\t\t\tindex: i * this.pPerSlice\n\t\t\t};\n\n\t\t\t// render to screen\n\t\t\tthis.particleMesh.material = this.material;\n\t\t\trenderer.render( this.pScene, camera );\n\n\t\t\t// render opacityMap\n\t\t\tthis.opacityMaterial.uniforms = this.material.uniforms;\n\t\t\tthis.particleMesh.material = this.opacityMaterial;\n\t\t\trenderer.render( this.pScene, this.lightCam, this.opacityMap );\n\n\t\t}\n\n\t\t// reset render target\n\t\trenderer.setRenderTarget( this.dummyRenderTarget );\n\n\t},\n\n\tcomputeHalfAngle: function( camera ) {\n\n\t\tvar eye = new THREE.Vector3( 0, 0, -1 );\n\t\tvar light = new THREE.Vector3( 0, -1, 0 );\n\t\tvar hf = new THREE.Vector3();\n\n\t\teye.applyQuaternion( camera.quaternion );\n\t\teye.normalize();\n\t\tlight.normalize();\n\n\t\tif ( eye.dot( light ) > 0.0 ) {\n\n\t\t\thf.addVectors( eye, light );\n\t\t\tthis.material.blendSrc = THREE.OneFactor\n\t\t\tthis.material.blendDst = THREE.OneMinusSrcAlphaFactor\n\n\t\t} else {\n\n\t\t\teye.multiplyScalar( -1 );\n\t\t\thf.addVectors( eye, light );\n\t\t\tthis.material.blendSrc = THREE.OneMinusDstAlphaFactor\n\t\t\tthis.material.blendDst = THREE.OneFactor\n\n\t\t}\n\n\t\thf.normalize();\n\t\tthis.halfAngle = hf;\n\n\t\treturn hf;\n\n\t}\n\n};\n","'use strict';\n\nfunction main() {\n\n\tinitParticleSystem();\n\n\t$$.hud = new HUD( RENDERER );\n\n\tinitBackground();\n\n\tinitGui();\n\n}\n\n\nfunction initParticleSystem() {\n\n\t$$.uniformsInput = {\n\t\ttime     : { type: 'f', value: 0.0 },\n\t\ttimeMult : { type: 'f', value: 0.27 },\n\t\tnoiseFreq: { type: 'f', value: 1.4 },\n\t\tspeed    : { type: 'f', value: 45.0 }\n\t};\n\n\t$$.sortUniforms = {\n\t\tpass: { type: 'f', value: -1 },\n\t\tstage: { type: 'f', value: -1 },\n\t\tlookAt: { type: 'v3', value: new THREE.Vector3( 0, 0, -1 ) },\n\t\thalfAngle: { type: 'v3', value: new THREE.Vector3() },\n\t\tsortOrder: { type: 'f', value: 1 }\n\t};\n\n\n\tvar numParSq = 256;\n\t$$.FBOC = new FBOCompositor( RENDERER, numParSq, SHADERS.passVert );\n\t$$.FBOC.addPass( 'velocityPass', SHADERS.velocity, { positionBuffer: 'positionPass' }, $$.uniformsInput );\n\t$$.FBOC.addPass( 'positionPass', SHADERS.position, { velocityBuffer: 'velocityPass' }, $$.uniformsInput );\n\t$$.FBOC.addPass( 'sortPass', SHADERS.sort, {}, $$.sortUniforms );\n\n\t$$.psys = new ParticleSystem( numParSq );\n\t$$.psys.init();\n\n\tvar initialPositionDataTexture = $$.psys.generatePositionTexture();\n\t$$.FBOC.renderInitialBuffer( initialPositionDataTexture, 'positionPass' );\n\n}\n\nfunction initBackground() {\n\n\t$$.bgGeo = new THREE.PlaneBufferGeometry( 2, 2 );\n\t$$.bgMat = new THREE.MeshBasicMaterial( {\n\n\t\tcolor: SCENE_SETTINGS.bgColor,\n\t\tside: THREE.DoubleSide,\n\t\ttransparent: true,\n\n\t\tblending: THREE.CustomBlending,\n\t\tblendEquation: THREE.AddEquation,\n\t\tblendSrc: THREE.OneMinusDstAlphaFactor,\n\t\tblendDst: THREE.OneFactor\n\n\t} );\n\t$$.bgMesh = new THREE.Mesh( $$.bgGeo, $$.bgMat );\n\t$$.bgScene = new THREE.Scene();\n\t$$.bgCam = new THREE.Camera();\n\t$$.bgScene.add( $$.bgMesh );\n\n}\n","// !todo: fix  particle flickering because velocity buffer not sync with sorted position buffer\n// !todo: when rotate mesh, sorting axis is wrong\n// !todo: fix particle stop sorting when pause and changing camera angle\n\n'use strict';\n\nfunction update() {\n\n\t$$.uniformsInput.time.value = CLOCK.getElapsedTime();\n\n\t$$.psys.computeHalfAngle( CAMERA );\n\t$$.sortUniforms.halfAngle.value = $$.psys.halfAngle;\n\t$$.FBOC.step();\n\t$$.psys.setPositionBuffer( $$.FBOC.getPass( 'sortPass' ).getRenderTarget() );\n\n\tupdateGuiDisplay();\n\n}\n\n\n// ----  draw loop\nfunction run() {\n\n\trequestAnimationFrame( run );\n\n\tRENDERER.setClearColor( 0, 0.0 );\n\tRENDERER.clear();\n\n\tif ( !SCENE_SETTINGS.pause ) {\n\t\tupdate();\n\t}\n\n\tRENDERER.render( SCENE, CAMERA );\n\n\t$$.psys.render( RENDERER, CAMERA );\n\n\tRENDERER.render( $$.bgScene, $$.bgCam );\n\n\tif ( SCENE_SETTINGS.showFrameBuffer ) {\n\t\t$$.hud.setInputTexture( $$.psys.opacityMap );\n\t\t$$.hud.render();\n\t}\n\n\tSTATS.update();\n\n}\n","'use strict';\n\nwindow.addEventListener( 'keypress', ( event ) => {\n\n\tvar key = event.keyCode;\n\n\tswitch( key ) {\n\n\t\tcase 32: SCENE_SETTINGS.pause = !SCENE_SETTINGS.pause;\n\t\tbreak;\n\n\t\tcase 65:/*A*/\n\t\tcase 97:/*a*/ SCENE_SETTINGS.enableGridHelper = !SCENE_SETTINGS.enableGridHelper; updateHelpers();\n\t\tbreak;\n\n\t\tcase 83 :/*S*/\n\t\tcase 115:/*s*/ SCENE_SETTINGS.enableAxisHelper = !SCENE_SETTINGS.enableAxisHelper; updateHelpers();\n\t\tbreak;\n\n\t}\n\n} );\n\n\nwindow.addEventListener( 'resize', debounce( onWindowResize, 200 ) );\n\nfunction onWindowResize() {\n\n\tWIDTH = window.innerWidth;\n\tHEIGHT = window.innerHeight;\n\n\tPIXEL_RATIO = window.devicePIXEL_RATIO || 1;\n\tSCREEN_RATIO = WIDTH / HEIGHT;\n\n\tCAMERA.aspect = SCREEN_RATIO;\n\tCAMERA.updateProjectionMatrix();\n\n\tRENDERER.setSize( WIDTH, HEIGHT );\n\tRENDERER.setPixelRatio( PIXEL_RATIO );\n\n\t$$.hud.update();\n\n}\n","\nfunction debounce(func, wait, immediate) {\n\n\tvar timeout;\n\treturn () => {\n\n\t\tvar context = this, args = arguments;\n\t\tvar later = () => {\n\n\t\t\ttimeout = null;\n\t\t\tif (!immediate) func.apply(context, args);\n\n\t\t};\n\t\tvar callNow = immediate && !timeout;\n\t\tclearTimeout(timeout);\n\t\ttimeout = setTimeout(later, wait);\n\t\tif (callNow) func.apply(context, args);\n\n\t};\n\n}\n"],"sourceRoot":"/source/"}